import{c as re,a as _,t as k}from"./disclose-version.DTAQul2H.js";import{f as C,p as ve,d as f,t as D,a as fe,b as r,g as e,c as o,s as l,r as n}from"./runtime.B4QXH2CN.js";import{d as me,e as he,a as q}from"./store.D_on7m4h.js";import{i as w}from"./if.DRLG6bOh.js";import{r as E,s as X}from"./attributes.DPN48yOH.js";import{b as P}from"./input.Br29pWBN.js";import{l as ae,s as se,a as _e}from"./preload-helper.B2IhT0O3.js";import{I as ie,s as oe,a as z}from"./Icon.yFnM2WBm.js";import{E as ee}from"./eye.BPTSt0Sg.js";import{E as te}from"./eye-off.BLnrzLPS.js";function be(p,s){const c=ae(s,["children","$$slots","$$events","$$legacy"]);ie(p,se({name:"moon"},()=>c,{iconNode:[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"}]],children:(m,L)=>{var v=re(),b=C(v);oe(b,s,"default",{}),_(m,v)},$$slots:{default:!0}}))}function xe(p,s){const c=ae(s,["children","$$slots","$$events","$$legacy"]);ie(p,se({name:"sun"},()=>c,{iconNode:[["circle",{cx:"12",cy:"12",r:"4"}],["path",{d:"M12 2v2"}],["path",{d:"M12 20v2"}],["path",{d:"m4.93 4.93 1.41 1.41"}],["path",{d:"m17.66 17.66 1.41 1.41"}],["path",{d:"M2 12h2"}],["path",{d:"M20 12h2"}],["path",{d:"m6.34 17.66-1.41 1.41"}],["path",{d:"m19.07 4.93-1.41 1.41"}]],children:(m,L)=>{var v=re(),b=C(v);oe(b,s,"default",{}),_(m,v)},$$slots:{default:!0}}))}function we(p,s){r(s,!e(s)),document.documentElement.classList.toggle("dark")}async function ke(p,s){try{const{error:c}=await z.auth.signInWithOAuth({provider:"azure",options:{scopes:"email openid profile",redirectTo:"https://eqkwwbmbswmpjpfzttov.supabase.co/auth/v1/callback"}});if(c){r(s,`Failed to initiate Azure login: ${c.message}`),console.error("Azure login initiation error:",c);return}r(s,"Redirecting to Azure login...")}catch(c){console.error("Error during Azure sign-in:",c),r(s,"Unexpected error occurred. Please try again.")}}var ye=k('<div class="flex gap-4"><input type="text" placeholder="First Name" required class="input input-bordered w-full dark:bg-gray-800 dark:text-white dark:border-gray-700"> <input type="text" placeholder="Last Name" required class="input input-bordered w-full dark:bg-gray-800 dark:text-white dark:border-gray-700"></div>'),$e=(p,s)=>r(s,!e(s)),Le=(p,s)=>r(s,!e(s)),Me=k('<div class="relative"><input placeholder="Confirm Password" required class="input input-bordered w-full dark:bg-gray-800 dark:text-white dark:border-gray-700"> <button type="button" class="absolute inset-y-0 right-4 flex items-center dark:text-gray-400"><!></button></div>'),Ee=k('<span class="loading loading-spinner loading-sm"></span>'),Pe=k('<p class="text-sm text-center mt-4 text-error dark:text-red-400"> </p>'),ze=(p,s)=>r(s,!1),Ae=k(`Don't have an account? <button class="text-primary dark:text-blue-400 font-medium">Register</button>`,1),je=(p,s)=>r(s,!0),Ne=k('Already have an account? <button class="text-primary dark:text-blue-400 font-medium">Login</button>',1),qe=k(`<div class="min-h-screen grid lg:grid-cols-2 transition-colors duration-300 dark:bg-gray-900"><button class="fixed top-4 right-4 p-2 rounded-full bg-gray-200 dark:bg-gray-700 z-50" aria-label="Toggle theme"><!></button> <div class="relative hidden lg:block bg-cover bg-center" style="background-image: linear-gradient(180deg, rgba(103, 21, 21, 0.8) 0%, rgba(103, 21, 21, 0.3) 50%), url('/images/login_bg.png');"><div class="relative z-10 h-full flex flex-col items-center justify-center space-y-4 p-10"><div class="text-center"><h1 class="text-5xl font-extrabold text-white tracking-tight mb-4">EuCorp</h1> <p class="text-xl text-gray-300 max-w-md">Our Institutional Planning System</p></div> <div class="mt-6 space-y-2 text-gray-200"><div class="flex items-center space-x-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> <p>Streamline Project Management</p></div> <div class="flex items-center space-x-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> <p>Enhance Collaboration</p></div> <div class="flex items-center space-x-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> <p>Monitor Progress Effectively</p></div></div></div></div> <div class="flex items-center justify-center px-8"><div class="w-full max-w-md"><div class="text-center mb-8"><h1 class="text-2xl font-semibold dark:text-white"> </h1> <p class="text-gray-600 dark:text-gray-400"> </p></div> <form class="space-y-4"><!> <input type="email" placeholder="name@example.com" required class="input input-bordered w-full dark:bg-gray-800 dark:text-white dark:border-gray-700"> <div class="relative"><input placeholder="Password" required class="input input-bordered w-full dark:bg-gray-800 dark:text-white dark:border-gray-700"> <button type="button" class="absolute inset-y-0 right-4 flex items-center dark:text-gray-400"><!></button></div> <!> <button type="submit" class="btn bg-rose-700 w-full text-white hover:bg-rose-800 dark:bg-rose-800 dark:hover:bg-rose-900"><!> <span> </span></button></form> <!> <div class="divider dark:text-gray-400">OR</div> <button type="button" class="btn bg-blue-600 w-full text-white hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 flex items-center justify-center space-x-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" class="w-5 h-5" fill="none"><path d="M126.23 14.7L0 207.43h71.54L126.23 80.7l54.7 126.74h71.54L126.23 14.7Z" fill="#0078D4"></path><path d="M88.73 213.22H176l-44.76-79.55-42.51 79.55Z" fill="#008AD7"></path><path d="M176 213.22H252L200.28 127l-24.28 86.22Z" fill="#0079B7"></path></svg> <span>Sign in with Azure</span></button> <p class="text-sm text-center mt-4 dark:text-gray-400"><!></p></div></div></div>`);function He(p,s){ve(s,!0);let c=f(_e(window.matchMedia("(prefers-color-scheme: dark)").matches)),y=f(""),m=f(""),L=f(""),v=f(""),b=f(""),u=f(""),g=f(!1),h=f(!0),$=f(!1);async function ne(){if(r(g,!0),r(u,""),e(h)){const{data:t,error:a}=await z.auth.signInWithPassword({email:e(y),password:e(m)});if(a){r(u,`Failed to login: ${a.message}`),console.error("Login error:",a),r(g,!1);return}const i=t==null?void 0:t.user;if(i){const{data:d,error:x}=await z.from("profiles").select("is_verified").eq("id",i.id).single();if(x){console.error("Error fetching profile:",x),r(u,"Error checking verification status."),r(g,!1);return}if(!(d!=null&&d.is_verified)){r(u,"Your account is pending verification."),r(g,!1);return}r(u,"Login successful! Redirecting..."),setTimeout(()=>{window.location.href="/dashboard"},1e3)}}else{if(e(m)!==e(L)){r(u,"Passwords do not match."),r(g,!1);return}const{data:t,error:a}=await z.auth.signUp({email:e(y),password:e(m),options:{data:{first_name:e(v),last_name:e(b)}}});if(a){r(u,`Failed to register: ${a.message}`),console.error("Registration error:",a),r(g,!1);return}const i=t==null?void 0:t.user;if(i){const{error:d}=await z.from("profiles").insert({id:i.id,email:i.email,first_name:e(v),last_name:e(b),role:"user",is_verified:!1});if(d){console.error("Error inserting profile:",d),r(u,"Profile creation failed. Please try again later."),r(g,!1);return}}r(u,"Registration successful! Please check your email for verification.")}r(g,!1)}var R=qe(),A=o(R);A.__click=[we,c];var le=o(A);w(le,()=>e(c),t=>{xe(t,{class:"w-5 h-5 text-yellow-500"})},t=>{be(t,{class:"w-5 h-5 text-gray-700"})}),n(A);var O=l(A,4),H=o(O),S=o(H),I=o(S),de=o(I,!0);n(I);var U=l(I,2),ce=o(U,!0);n(U),n(S);var j=l(S,2),W=o(j);w(W,()=>!e(h),t=>{var a=ye(),i=o(a);E(i);var d=l(i,2);E(d),n(a),P(i,()=>e(v),x=>r(v,x)),P(d,()=>e(b),x=>r(b,x)),_(t,a)});var B=l(W,2);E(B);var F=l(B,2),N=o(F);E(N);var T=l(N,2);T.__click=[$e,$];var ue=o(T);w(ue,()=>e($),t=>{te(t,{class:"w-5 h-5"})},t=>{ee(t,{class:"w-5 h-5"})}),n(T),n(F);var Y=l(F,2);w(Y,()=>!e(h),t=>{var a=Me(),i=o(a);E(i);var d=l(i,2);d.__click=[Le,$];var x=o(d);w(x,()=>e($),M=>{te(M,{class:"w-5 h-5"})},M=>{ee(M,{class:"w-5 h-5"})}),n(d),n(a),D(()=>X(i,"type",e($)?"text":"password")),P(i,()=>e(L),M=>r(L,M)),_(t,a)});var Z=l(Y,2),G=o(Z);w(G,()=>e(g),t=>{var a=Ee();_(t,a)});var J=l(G,2),pe=o(J,!0);n(J),n(Z),n(j);var K=l(j,2);w(K,()=>e(u),t=>{var a=Pe(),i=o(a,!0);n(a),D(()=>q(i,e(u))),_(t,a)});var Q=l(K,4);Q.__click=[ke,u];var V=l(Q,2),ge=o(V);w(ge,()=>e(h),t=>{var a=Ae(),i=l(C(a));i.__click=[ze,h],_(t,a)},t=>{var a=Ne(),i=l(C(a));i.__click=[je,h],_(t,a)}),n(V),n(H),n(O),n(R),D(()=>{q(de,e(h)?"Login":"Create an Account"),q(ce,e(h)?"Sign in to continue":"Enter your details to register"),X(N,"type",e($)?"text":"password"),Z.disabled=e(g),q(pe,e(g)?"Processing...":e(h)?"Login":"Register")}),he("submit",j,ne),P(B,()=>e(y),t=>r(y,t)),P(N,()=>e(m),t=>r(m,t)),_(p,R),fe()}me(["click"]);export{He as L,be as M,xe as S};
