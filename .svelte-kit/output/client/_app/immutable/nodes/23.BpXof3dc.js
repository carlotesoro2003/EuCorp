import{c as oe,a as h,t as D}from"../chunks/disclose-version.DTAQul2H.js";import{f as B,p as ke,d as F,a as ze,b as l,c as t,g as r,e as je,n as ae,r as e,s as d,t as $}from"../chunks/runtime.B4QXH2CN.js";import{d as Ce,e as Ee,a as M}from"../chunks/store.D_on7m4h.js";import{i as O}from"../chunks/if.DRLG6bOh.js";import{e as Fe,r as Q,i as Ie,s as Le}from"../chunks/attributes.DPN48yOH.js";import{t as I,f as P,b as Ne}from"../chunks/index.A-vRoXhT.js";import{b as V}from"../chunks/input.Br29pWBN.js";import{l as me,s as fe,a as T}from"../chunks/preload-helper.B2IhT0O3.js";import{o as Pe}from"../chunks/index-client.Bib29rnf.js";import{I as _e,s as he,a as X}from"../chunks/Icon.yFnM2WBm.js";import{S as Te}from"../chunks/search.K0UJueoa.js";import{P as qe}from"../chunks/plus.BfN9yc11.js";import{X as pe}from"../chunks/x.xw5d-c1A.js";import{P as Ae}from"../chunks/pencil.BlEN5tg-.js";import{T as He}from"../chunks/trash-2.DnhmlcTU.js";function Oe(b,c){const u=me(c,["children","$$slots","$$events","$$legacy"]);_e(b,fe({name:"calendar-range"},()=>u,{iconNode:[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2"}],["path",{d:"M16 2v4"}],["path",{d:"M3 10h18"}],["path",{d:"M8 2v4"}],["path",{d:"M17 14h-6"}],["path",{d:"M13 18H7"}],["path",{d:"M7 14h.01"}],["path",{d:"M17 18h.01"}]],children:(p,Y)=>{var o=oe(),g=B(o);he(g,c,"default",{}),h(p,o)},$$slots:{default:!0}}))}function Qe(b,c){const u=me(c,["children","$$slots","$$events","$$legacy"]);_e(b,fe({name:"school"},()=>u,{iconNode:[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10"}],["path",{d:"M18 5v17"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6"}],["path",{d:"M6 5v17"}],["circle",{cx:"12",cy:"9",r:"2"}]],children:(p,Y)=>{var o=oe(),g=B(o);he(g,c,"default",{}),h(p,o)},$$slots:{default:!0}}))}const Ve=(b,c,u)=>{l(c,T({id:0,school_year:"",start_date:"",end_date:""})),l(u,!0)};var Xe=D('<div class="mb-6"><div class="bg-destructive/10 text-destructive px-4 py-3 rounded-lg flex items-center gap-2"><!> <p> </p></div></div>'),Be=D('<div class="flex justify-center p-8"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div></div>'),Ge=D('<div class="text-center py-12 bg-card rounded-lg border border-border"><!> <h3 class="text-lg font-semibold mb-2">No School Years Found</h3> <p class="text-muted-foreground">Start by adding a new school year.</p></div>'),Je=(b,c,u)=>c(r(u)),Ke=(b,c,u)=>c(r(u).id),Re=D('<tr class="hover:bg-muted/50 transition-colors"><td class="px-6 py-4 font-medium"> </td><td class="px-6 py-4"> </td><td class="px-6 py-4"> </td><td class="px-6 py-4"> </td><td class="px-6 py-4"><div class="flex items-center gap-4"><button class="p-2 hover:bg-muted rounded-lg text-muted-foreground hover:text-foreground" title="Edit"><!></button> <button class="p-2 hover:bg-red-100 text-red-500 hover:text-red-600 rounded-lg disabled:opacity-50" title="Delete"><!></button></div></td></tr>'),Ue=D('<div class="overflow-x-auto bg-card rounded-lg shadow border border-border"><table class="w-full"><thead class="bg-muted/50"><tr><th class="px-6 py-4 text-left font-medium">School Year</th><th class="px-6 py-4 text-left font-medium">Start Date</th><th class="px-6 py-4 text-left font-medium">End Date</th><th class="px-6 py-4 text-left font-medium">Mid Year</th><th class="px-6 py-4 text-left font-medium">Actions</th></tr></thead><tbody class="divide-y divide-border"></tbody></table></div>'),We=D('<div class="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50"><div class="bg-card p-6 rounded-lg w-full max-w-md relative border border-border shadow-lg"><div class="flex justify-between items-center mb-6"><h2 class="text-xl font-semibold"> </h2> <button class="p-1 hover:bg-muted rounded-lg transition-colors" title="Close"><!></button></div> <form><div class="space-y-4"><div><label for="school_year" class="block text-sm font-medium mb-1">School Year</label> <input id="school_year" type="text" class="w-full px-4 py-2 rounded-lg border border-border bg-background focus:outline-none focus:ring-2 focus:ring-primary/20" placeholder="2023-2024" required></div> <div class="grid grid-cols-2 gap-4"><div class="space-y-2"><label for="start_date" class="text-sm font-medium">Start Date</label> <input type="date" id="start_date" class="w-full px-3 py-2 border rounded-md" required></div> <div class="space-y-2"><label for="end_date" class="text-sm font-medium">End Date</label> <input type="date" id="end_date" class="w-full px-3 py-2 border rounded-md" required></div></div></div> <div class="flex justify-end gap-4 mt-6"><button type="button" class="px-4 py-2 rounded-lg border border-border hover:bg-muted transition-colors">Cancel</button> <button type="submit" class="px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50"> </button></div></form></div></div>'),Ze=D('<div class="container px-6 py-6 mx-auto"><div class="flex flex-col gap-6 mb-8"><div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"><div class="flex items-center gap-2"><!> <h1 class="text-2xl font-bold">School Years Management</h1></div></div> <div class="flex flex-col md:flex-row justify-between gap-4 w-full"><div class="relative flex-1 w-full md:max-w-[300px]"><!> <input type="text" placeholder="Search school years..." class="pl-10 sm:max-w-md px-4 py-2 bg-secondary border-secondary rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-ring"></div> <div class="flex gap-2 w-full md:w-auto md:justify-end"><button class="flex items-center gap-2 bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:bg-primary/90 transition-colors"><!> <span>Add New Year</span></button></div></div></div> <!> <!></div> <!>',1);function ft(b,c){ke(c,!0);let u=F(T([])),m=F(!1),p=F(null),Y=F(!1),o=F(null),g=F("");T({school_year:"",start_date:"",end_date:"",mid_year:""});const be=()=>r(o).start_date||new Date().toISOString().split("T")[0],se=je(()=>r(u).filter(s=>s.school_year.toLowerCase().includes(r(g).toLowerCase()))),G=async()=>{try{l(m,!0),l(p,null);const{data:s,error:a}=await X.from("school_years").select("*").order("start_date",{ascending:!0});if(a)throw a;l(u,T(s))}catch(s){console.error("Error fetching school years:",s),l(p,"Failed to fetch school years.")}finally{l(m,!1)}},ye=(s,a)=>{const v=new Date(s),i=new Date(a);return new Date((v.getTime()+i.getTime())/2).toISOString().split("T")[0]},ge=async s=>{if(s.preventDefault(),!!r(o))try{l(m,!0),l(p,null);const a=ye(r(o).start_date,r(o).end_date),v={school_year:r(o).school_year,start_date:r(o).start_date,end_date:r(o).end_date,mid_year:a};if(r(o).id){const{error:i}=await X.from("school_years").update(v).eq("id",r(o).id);if(i)throw i}else{const{error:i}=await X.from("school_years").insert(v);if(i)throw i}await G(),J()}catch(a){console.error(a),l(p,`Failed to ${r(o).id?"update":"create"} school year.`)}finally{l(m,!1)}},xe=async s=>{if(confirm("Are you sure you want to delete this school year?"))try{l(m,!0),l(p,null);const{error:a}=await X.from("school_years").delete().eq("id",s);if(a)throw a;await G()}catch(a){console.error("Error deleting school year:",a),l(p,"Failed to delete school year.")}finally{l(m,!1)}},J=()=>{l(Y,!1),l(o,null)},we=s=>{l(o,T({...s})),l(Y,!0)},K=s=>new Date(s).toLocaleDateString();Pe(()=>{G()});var de=Ze(),R=B(de),U=t(R),W=t(U),le=t(W),Se=t(le);Qe(Se,{class:"w-8 h-8 text-primary"}),ae(2),e(le),e(W);var ie=d(W,2),Z=t(ie),ne=t(Z);Te(ne,{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground",size:20});var ce=d(ne,2);Q(ce),e(Z);var ve=d(Z,2),ee=t(ve);ee.__click=[Ve,o,Y];var $e=t(ee);qe($e,{size:20}),ae(2),e(ee),e(ve),e(ie),e(U);var ue=d(U,2);O(ue,()=>r(p),s=>{var a=Xe(),v=t(a),i=t(v);pe(i,{size:20});var n=d(i,2),y=t(n,!0);e(n),e(v),e(a),$(()=>M(y,r(p))),I(3,a,()=>P),h(s,a)});var Me=d(ue,2);O(Me,()=>r(m),s=>{var a=Be();I(3,a,()=>P),h(s,a)},s=>{var a=oe(),v=B(a);O(v,()=>r(se).length===0,i=>{var n=Ge(),y=t(n);Oe(y,{size:48,class:"mx-auto text-muted-foreground mb-4"}),ae(4),e(n),I(3,n,()=>P),h(i,n)},i=>{var n=Ue(),y=t(n),k=d(t(y));Fe(k,21,()=>r(se),Ie,(te,f)=>{var x=Re(),w=t(x),q=t(w,!0);e(w);var z=d(w),L=t(z,!0);$(()=>M(L,K(r(f).start_date))),e(z);var j=d(z),A=t(j,!0);$(()=>M(A,K(r(f).end_date))),e(j);var S=d(j),H=t(S,!0);$(()=>M(H,r(f).mid_year?K(r(f).mid_year):"-")),e(S);var N=d(S),C=t(N),E=t(C);E.__click=[Je,we,f];var _=t(E);Ae(_,{size:18}),e(E);var re=d(E,2);re.__click=[Ke,xe,f];var Ye=t(re);He(Ye,{size:18}),e(re),e(C),e(N),e(x),$(()=>M(q,r(f).school_year)),h(te,x)}),e(k),e(y),e(n),I(3,n,()=>P),h(i,n)},!0),h(s,a)}),e(R);var De=d(R,2);O(De,()=>r(Y),s=>{var a=We(),v=t(a),i=t(v),n=t(i),y=t(n,!0);e(n);var k=d(n,2);k.__click=J;var te=t(k);pe(te,{size:20}),e(k),e(i);var f=d(i,2),x=t(f),w=t(x),q=d(t(w),2);Q(q),e(w);var z=d(w,2),L=t(z),j=d(t(L),2);Q(j),e(L);var A=d(L,2),S=d(t(A),2);Q(S),$(()=>Le(S,"min",be())),e(A),e(z),e(x);var H=d(x,2),N=t(H);N.__click=J;var C=d(N,2),E=t(C,!0);e(C),e(H),e(f),e(v),e(a),$(()=>{var _;M(y,(_=r(o))!=null&&_.id?"Edit School Year":"Create School Year"),C.disabled=r(m),M(E,r(m)?"Saving...":"Save")}),Ee("submit",f,ge),V(q,()=>r(o).school_year,_=>r(o).school_year=_),V(j,()=>r(o).start_date,_=>r(o).start_date=_),V(S,()=>r(o).end_date,_=>r(o).end_date=_),I(3,v,()=>Ne,()=>({duration:200})),I(3,a,()=>P,()=>({duration:200})),h(s,a)}),V(ce,()=>r(g),s=>l(g,s)),h(b,de),ze()}Ce(["click"]);export{ft as component};
