import{c as je,a as w,t as M}from"../chunks/disclose-version.DTAQul2H.js";import{f as fe,p as O,d as p,t as T,b as n,g as e,a as Q,c as r,r as t,s as l,n as ee,e as te}from"../chunks/runtime.B4QXH2CN.js";import{i as Ce}from"../chunks/lifecycle.DAFDPKuL.js";import{o as ge}from"../chunks/index-client.Bib29rnf.js";/* empty css                         */import{I as Ne,s as ze,a as L}from"../chunks/Icon.yFnM2WBm.js";import{e as Ae,a as A,d as _e}from"../chunks/store.D_on7m4h.js";import{i as ae}from"../chunks/if.DRLG6bOh.js";import{r as re,e as Pe}from"../chunks/attributes.DPN48yOH.js";import{s as Le}from"../chunks/class.BN6JjLqI.js";import{t as Te,f as Fe}from"../chunks/index.A-vRoXhT.js";import{b as oe}from"../chunks/input.Br29pWBN.js";import{b as qe}from"../chunks/select.CXmm0mL2.js";import{l as Ue,s as Be,p as Ie,a as z}from"../chunks/preload-helper.B2IhT0O3.js";import{P as Re}from"../chunks/pencil.BlEN5tg-.js";import{T as Oe}from"../chunks/trash-2.DnhmlcTU.js";import{S as Qe}from"../chunks/search.K0UJueoa.js";import{D as Ve}from"../chunks/download.CXU6lRmm.js";import{P as Xe}from"../chunks/plus.BfN9yc11.js";import{X as Ge}from"../chunks/x.xw5d-c1A.js";function He(f,a){const d=Ue(a,["children","$$slots","$$events","$$legacy"]);Ne(f,Be({name:"building"},()=>d,{iconNode:[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2"}],["path",{d:"M9 22v-4h6v4"}],["path",{d:"M8 6h.01"}],["path",{d:"M16 6h.01"}],["path",{d:"M12 6h.01"}],["path",{d:"M12 10h.01"}],["path",{d:"M12 14h.01"}],["path",{d:"M16 10h.01"}],["path",{d:"M16 14h.01"}],["path",{d:"M8 10h.01"}],["path",{d:"M8 14h.01"}]],children:(i,v)=>{var c=je(),u=fe(c);ze(u,a,"default",{}),w(i,c)},$$slots:{default:!0}}))}var Je=M('<form class="space-y-4"><h3 class="text-lg font-semibold"> </h3> <div class="space-y-2"><label for="fullName" class="text-sm font-medium">Full Name</label> <input id="fullName" type="text" required class="w-full px-3 py-2 rounded-lg bg-secondary border-secondary focus:outline-none focus:ring-2 focus:ring-ring" placeholder="Enter full name..."></div> <div class="space-y-2"><label for="name" class="text-sm font-medium">Short Name</label> <input id="name" type="text" required class="w-full px-3 py-2 rounded-lg bg-secondary border-secondary focus:outline-none focus:ring-2 focus:ring-ring" placeholder="Enter short name..."></div> <button type="submit" class="w-full bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:bg-primary/90 disabled:opacity-50"> </button></form>');function Ke(f,a){var F,q;O(a,!0);let d=Ie(a,"department",3,null),m=p(z(((F=d())==null?void 0:F.name)??"")),i=p(z(((q=d())==null?void 0:q.full_name)??""));const v=g=>{var E;g.preventDefault(),a.onSave({id:((E=d())==null?void 0:E.id)??null,name:e(m),full_name:e(i)})};var c=Je(),u=r(c),S=r(u);t(u);var b=l(u,2),D=l(r(b),2);re(D),t(b);var _=l(b,2),k=l(r(_),2);re(k),t(_);var x=l(_,2),y=r(x);t(x),t(c),T(()=>{A(S,`${(d()?"Edit":"Add")??""} Department`),x.disabled=a.isSaving,A(y,`${(a.isSaving?"Saving...":d()?"Update":"Add")??""} Department`)}),Ae("submit",c,v),oe(D,()=>e(i),g=>n(i,g)),oe(k,()=>e(m),g=>n(m,g)),w(f,c),Q()}var We=(f,a)=>a.onDelete(a.department.id),Ye=M('<div class="bg-card rounded-lg p-4 border border-border hover:shadow-lg transition-shadow"><div class="space-y-4"><h3 class="text-lg font-medium truncate"> </h3> <div class="inline-flex px-3 py-1 rounded-full text-sm font-medium bg-primary/10 text-primary"> </div> <div class="flex justify-end gap-2 pt-4"><button class="p-2 hover:bg-muted rounded-lg text-muted-foreground hover:text-foreground" title="Edit department"><!></button> <button class="p-2 hover:bg-red-100 text-red-500 hover:text-red-600 rounded-lg disabled:opacity-50" title="Delete department"><!></button></div></div></div>');function Ze(f,a){O(a,!0);var d=Ye(),m=r(d),i=r(m),v=r(i,!0);t(i);var c=l(i,2),u=r(c,!0);t(c);var S=l(c,2),b=r(S);b.__click=function(...x){var y;(y=a.onEdit)==null||y.apply(this,x)};var D=r(b);Re(D,{size:18}),t(b);var _=l(b,2);_.__click=[We,a];var k=r(_);Oe(k,{size:18}),t(_),t(S),t(m),t(d),T(()=>{A(v,a.department.full_name),A(u,a.department.name),_.disabled=a.isDeleting}),w(f,d),Q()}_e(["click"]);var $e=M("<div> </div>"),et=(f,a,d)=>{n(a,null),n(d,!0)},tt=M('<div class="flex justify-center p-8"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div></div>'),at=(f,a)=>n(a,e(a)-1),rt=(f,a)=>n(a,e(a)+1),ot=M('<div class="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50"><div class="bg-card p-6 rounded-lg w-full max-w-md relative border border-border"><button class="absolute right-4 top-4 p-1 hover:bg-muted rounded-lg"><!></button> <!></div></div>'),st=M('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div> <div class="flex flex-col sm:flex-row justify-between items-center gap-4"><div class="text-sm text-muted-foreground"> </div> <div class="flex flex-col sm:flex-row items-center gap-4"><select class="bg-secondary border-secondary rounded-lg px-2 py-1 focus:outline-none focus:ring-2 focus:ring-ring w-full sm:w-auto"><option>6 per page</option><option>12 per page</option><option>24 per page</option><option>48 per page</option></select> <div class="flex gap-2"><button class="px-3 py-1 rounded-lg border border-border hover:bg-muted disabled:opacity-50">Previous</button> <button class="px-3 py-1 rounded-lg border border-border hover:bg-muted disabled:opacity-50">Next</button></div></div></div> <!>',1),nt=M('<div class="flex flex-col gap-4 container mx-auto"><div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"><div class="flex items-center gap-2"><!> <h1 class="text-2xl font-bold">Department Management</h1></div></div> <!> <div class="flex flex-col md:flex-row gap-4 items-center justify-between"><div class="relative flex-1 w-full md:max-w-[300px]"><!> <input type="text" placeholder="Search departments..." class="pl-10 pr-4 py-2 bg-secondary border-secondary rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-ring"></div> <div class="flex gap-2 w-full md:w-auto"><button class="flex items-center gap-2 bg-secondary text-foreground px-4 py-2 rounded-lg hover:bg-secondary/80 justify-center flex-1 md:flex-initial"><!> Export</button> <button class="flex items-center gap-2 bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:bg-primary/90 justify-center flex-1 md:flex-initial"><!> Add Department</button></div></div> <!></div>');function lt(f,a){O(a,!0);let d=p(z([])),m=p(""),i=p(1),v=p(6),c=p(!1),u=p(null),S=p(""),b=p("success"),D=p(!1),_=p(!1),k=p(!1),x=p(!1);ge(async()=>{await E()});const y=te(()=>e(d).filter(o=>o.name.toLowerCase().includes(e(m).toLowerCase())||o.full_name.toLowerCase().includes(e(m).toLowerCase())).sort((o,s)=>o.full_name.localeCompare(s.full_name))),F=te(()=>e(y).slice((e(i)-1)*e(v),e(i)*e(v))),q=te(()=>Math.ceil(e(y).length/e(v))),g=(o,s="success")=>{n(S,z(o)),n(b,z(s)),n(D,!0),setTimeout(()=>n(D,!1),3e3)},E=async()=>{n(x,!0);const{data:o,error:s}=await L.from("departments").select("id, name, full_name");s?g("Error fetching departments","error"):n(d,z(o)),n(x,!1)},be=()=>{const s=[["Name","Full Name"].join(","),...e(d).map(B=>[B.name,B.full_name].join(","))].join(`
`),j=new Blob([s],{type:"text/csv;charset=utf-8;"}),h=document.createElement("a"),P=URL.createObjectURL(j);h.setAttribute("href",P),h.setAttribute("download","departments.csv"),h.style.visibility="hidden",document.body.appendChild(h),h.click(),document.body.removeChild(h)},V=()=>{n(c,!1),n(u,null)},he=async o=>{if(n(_,!0),o.id){const{error:s}=await L.from("departments").update({name:o.name,full_name:o.full_name}).eq("id",o.id);s?g("Error updating department","error"):(g("Department updated successfully"),await E(),V())}else{const{error:s}=await L.from("departments").insert({name:o.name,full_name:o.full_name});s?g("Error adding department","error"):(g("Department added successfully"),await E(),V())}n(_,!1)},xe=async o=>{n(k,!0);const{error:s}=await L.from("departments").delete().eq("id",o);s?g("Error deleting department","error"):(g("Department deleted successfully"),await E()),n(k,!1)};var X=nt(),G=r(X),se=r(G),ye=r(se);He(ye,{class:"w-8 h-8 text-primary"}),ee(2),t(se),t(G);var ne=l(G,2);ae(ne,()=>e(D),o=>{var s=$e(),j=r(s,!0);t(s),T(()=>{Le(s,`p-4 rounded-lg ${e(b)==="success"?"bg-green-500/10 text-green-500":"bg-red-500/10 text-red-500"}`),A(j,e(S))}),w(o,s)});var H=l(ne,2),J=r(H),le=r(J);Qe(le,{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground",size:20});var ie=l(le,2);re(ie),t(J);var de=l(J,2),U=r(de);U.__click=be;var we=r(U);Ve(we,{size:20}),ee(),t(U);var K=l(U,2);K.__click=[et,u,c];var De=r(K);Xe(De,{size:20}),ee(),t(K),t(de),t(H);var ke=l(H,2);ae(ke,()=>e(x),o=>{var s=tt();w(o,s)},o=>{var s=st(),j=fe(s);Pe(j,21,()=>e(F),C=>C.id,(C,N)=>{Ze(C,{get department(){return e(N)},get isDeleting(){return e(k)},onEdit:()=>{n(u,z(e(N))),n(c,!0)},onDelete:xe})}),t(j);var h=l(j,2),P=r(h),B=r(P);T(()=>A(B,`Showing ${(e(i)-1)*e(v)+1} to ${Math.min(e(i)*e(v),e(y).length)??""} of ${e(y).length??""} results`)),t(P);var ce=l(P,2),I=r(ce),W=r(I);W.value=(W.__value=6)==null?"":6;var Y=l(W);Y.value=(Y.__value=12)==null?"":12;var Z=l(Y);Z.value=(Z.__value=24)==null?"":24;var ue=l(Z);ue.value=(ue.__value=48)==null?"":48,t(I);var me=l(I,2),$=r(me);$.__click=[at,i];var ve=l($,2);ve.__click=[rt,i],t(me),t(ce),t(h);var Me=l(h,2);ae(Me,()=>e(c),C=>{var N=ot(),pe=r(N),R=r(pe);R.__click=V;var Se=r(R);Ge(Se,{size:20}),t(R);var Ee=l(R,2);Ke(Ee,{get department(){return e(u)},get isSaving(){return e(_)},onSave:he}),t(pe),t(N),Te(3,N,()=>Fe,()=>({duration:200})),w(C,N)}),T(()=>{$.disabled=e(i)===1,ve.disabled=e(i)===e(q)}),qe(I,()=>e(v),C=>n(v,C)),w(o,s)}),t(X),oe(ie,()=>e(m),o=>n(m,o)),w(f,X),Q()}_e(["click"]);var it=M('<main class="container mx-auto min-h-screen p-4"><!></main>');function Ct(f,a){O(a,!1),ge(async()=>{await d()});const d=async()=>{const{data:c,error:u}=await L.from("departments").select("id, name, full_name");u&&m("Error fetching departments","error")},m=(c,u="success")=>{setTimeout(()=>!1,3e3)};Ce();var i=it(),v=r(i);lt(v,{}),t(i),w(f,i),Q()}export{Ct as component};
