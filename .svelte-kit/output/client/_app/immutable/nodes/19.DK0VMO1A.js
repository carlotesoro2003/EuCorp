import{c as A,a as u,t as $,b as me}from"../chunks/disclose-version.DTAQul2H.js";import{f as L,p as ve,a as ge,b as f,g as e,t as Z,d as w,c as r,s as l,r as t,n as ee}from"../chunks/runtime.B4QXH2CN.js";import{d as _e,e as C}from"../chunks/store.D_on7m4h.js";import{i as D}from"../chunks/if.DRLG6bOh.js";import{r as E,s as be,c as ae}from"../chunks/attributes.DPN48yOH.js";import{s as ye}from"../chunks/class.BN6JjLqI.js";import{t as he,a as xe}from"../chunks/index.A-vRoXhT.js";import{b as re}from"../chunks/input.Br29pWBN.js";import{l as te,s as se,a as N}from"../chunks/preload-helper.B2IhT0O3.js";import{I as ie,s as le,a as j}from"../chunks/Icon.yFnM2WBm.js";import{U as we}from"../chunks/user.DZaGwQNU.js";import{L as $e}from"../chunks/loader-circle.C4FWx07d.js";function Pe(v,p){const n=te(p,["children","$$slots","$$events","$$legacy"]);ie(v,se({name:"camera"},()=>n,{iconNode:[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"}],["circle",{cx:"12",cy:"13",r:"3"}]],children:(b,y)=>{var d=A(),m=L(d);le(m,p,"default",{}),u(b,d)},$$slots:{default:!0}}))}function Ne(v,p){const n=te(p,["children","$$slots","$$events","$$legacy"]);ie(v,se({name:"mail"},()=>n,{iconNode:[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"}]],children:(b,y)=>{var d=A(),m=L(d);le(m,p,"default",{}),u(b,d)},$$slots:{default:!0}}))}const Ue=async(v,p,n)=>{const a=v.target;a.files&&a.files[0]&&(f(p,N(a.files[0])),n())};var ke=$('<div class="flex justify-center p-8 "><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div></div>'),Ce=$('<img alt="Profile" class="w-full h-full object-cover">'),De=$('<div class="w-full h-full bg-gray-100 flex items-center justify-center"><!></div>'),Ee=$("<!> Saving...",1),je=$('<div class="bg-card rounded-xl shadow-sm p-6 md:p-8"><h1 class="text-3xl font-bold  mb-8">Profile Settings</h1> <form class="space-y-6"><div class="flex flex-col items-center gap-4"><div class="relative group cursor-pointer"><div><!></div> <div class="absolute inset-0 bg-black/40 rounded-full opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center"><!></div> <input type="file" accept="image/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer"></div> <p class="text-sm text-gray-500">Drag and drop or click to change profile picture</p></div> <div class="grid md:grid-cols-2 gap-6"><div class="space-y-2"><label for="firstName" class="block text-sm font-mediu">First Name</label> <input id="firstName" type="text" class=" w-full bg-secondary border-secondary rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-ring" placeholder="Enter your first name"></div> <div class="space-y-2"><label for="lastName" class="block text-sm font-medium">Last Name</label> <input id="lastName" type="text" class="w-full bg-secondary border-secondary rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-ring"></div> <div class="space-y-2"><label for="email" class="block text-sm font-medium ">Email</label> <div class="relative"><!> <input id="email" type="email" disabled class="w-full pl-9 pr-4 py-2  bg-secondary border-secondary rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-ring"></div></div> <div class="space-y-2"><label for="role" class="block text-sm font-medium">Role</label> <input id="role" type="text" disabled class="w-full bg-secondary border-secondary rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-ring"></div></div> <div class="flex justify-end pt-4"><button type="submit" class="px-6 py-2.5 bg-primary hover:bg-primary/90 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"><!></button></div></form></div>'),Le=$('<div class="min-h-screen w-full py-8 px-4"><div class="max-w-2xl mx-auto"><!></div></div>');function Ge(v,p){ve(p,!0);let{session:n}=p.data,a=w(null),b=w(!0),y=w(!1),d=w(null),m=w(null),U=w(!1);const oe=async()=>{if(n){const{user:o}=n,{data:s,error:g}=await j.from("profiles").select("first_name, last_name, email, role, profile_pic").eq("id",o.id).single();g?console.error("Error fetching user profile:",g.message):(f(a,N(s)),f(m,N(e(a).profile_pic||null)))}f(b,!1)},z=async()=>{if(!e(a)||!n)return;f(y,!0);const{user:o}=n;try{let s=e(a).profile_pic;if(e(d)){const{data:_,error:x}=await j.storage.from("profile-pictures").upload(`public/${o.id}/${e(d).name}`,e(d),{cacheControl:"3600",upsert:!0});if(x)throw x;_&&(s=j.storage.from("profile-pictures").getPublicUrl(_.path).data.publicUrl,f(m,N(s)))}const{error:g}=await j.from("profiles").update({first_name:e(a).first_name,last_name:e(a).last_name,email:e(a).email,profile_pic:s}).eq("id",o.id);if(g)throw g;const h=document.createElement("div");h.className="fixed bottom-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg",h.textContent="Profile updated successfully!",document.body.appendChild(h),setTimeout(()=>h.remove(),3e3)}catch(s){console.error("Error:",s)}finally{f(y,!1)}},ne=o=>{var s;o.preventDefault(),f(U,!1),(s=o.dataTransfer)!=null&&s.files.length&&(f(d,N(o.dataTransfer.files[0])),z())};oe();var I=Le(),B=r(I),de=r(B);D(de,()=>e(b),o=>{var s=ke();u(o,s)},o=>{var s=A(),g=L(s);D(g,()=>n!==null&&e(a),h=>{var _=je(),x=l(r(_),2),S=r(x),P=r(S),k=r(P),ce=r(k);D(ce,()=>e(m),i=>{var c=Ce();Z(()=>be(c,"src",e(m))),u(i,c)},i=>{var c=De(),V=r(c);we(V,{class:"w-12 h-12 text-gray-400"}),t(c),u(i,c)}),t(k);var T=l(k,2),fe=r(T);Pe(fe,{class:"w-8 h-8 text-white"}),t(T);var pe=l(T,2);pe.__change=[Ue,d,z],t(P),ee(2),t(S);var q=l(S,2),F=r(q),G=l(r(F),2);E(G),t(F);var M=l(F,2),J=l(r(M),2);E(J),t(M);var H=l(M,2),K=l(r(H),2),O=r(K);Ne(O,{class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"});var Q=l(O,2);E(Q),t(K),t(H);var W=l(H,2),X=l(r(W),2);E(X),t(W),t(q);var Y=l(q,2),R=r(Y),ue=r(R);D(ue,()=>e(y),i=>{var c=Ee(),V=L(c);$e(V,{class:"w-4 h-4 animate-spin"}),ee(),u(i,c)},i=>{var c=me("Save Changes");u(i,c)}),t(R),t(Y),t(x),t(_),Z(()=>{ye(k,`w-32 h-32 rounded-full overflow-hidden border-4 transition-all duration-300 ${e(U)?"border-primary scale-105":"border-gray-100"}`),ae(Q,e(a).email??""),ae(X,e(a).role??"User"),R.disabled=e(y)}),C("submit",x,z),C("dragover",P,i=>{i.preventDefault(),f(U,!0)}),C("dragleave",P,()=>f(U,!1)),C("drop",P,ne),re(G,()=>e(a).first_name,i=>e(a).first_name=i),re(J,()=>e(a).last_name,i=>e(a).last_name=i),he(1,_,()=>xe,()=>({y:20,duration:600})),u(h,_)},null,!0),u(o,s)}),t(B),t(I),u(v,I),ge()}_e(["change"]);export{Ge as component};
