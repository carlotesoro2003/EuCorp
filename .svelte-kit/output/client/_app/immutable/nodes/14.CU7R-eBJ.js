import{c as xe,a as G,t as z}from"../chunks/disclose-version.DTAQul2H.js";import{f as ve,p as pe,g as e,a as ue,c as a,r as t,s as l,t as Q,e as O,n as oe,d as b,b as u}from"../chunks/runtime.B4QXH2CN.js";import{d as ie,a as h}from"../chunks/store.D_on7m4h.js";import{i as _e}from"../chunks/if.DRLG6bOh.js";import{e as me,i as fe,s as he,r as be}from"../chunks/attributes.DPN48yOH.js";import{b as ye}from"../chunks/input.Br29pWBN.js";import{b as ge}from"../chunks/select.CXmm0mL2.js";import{l as we,s as ke,p as Se,a as P}from"../chunks/preload-helper.B2IhT0O3.js";import{I as Pe,s as Ge,a as W}from"../chunks/Icon.yFnM2WBm.js";import{g as Ie}from"../chunks/entry.Dq_-L3Yi.js";import{A as le}from"../chunks/arrow-up-down.0onLll3z.js";import{E as Me}from"../chunks/eye.BPTSt0Sg.js";import{T as Ce}from"../chunks/target.BDjRuX_8.js";import{S as Ee}from"../chunks/search.K0UJueoa.js";function ze(m,r){const x=we(r,["children","$$slots","$$events","$$legacy"]);Pe(m,ke({name:"notebook"},()=>x,{iconNode:[["path",{d:"M2 6h4"}],["path",{d:"M2 10h4"}],["path",{d:"M2 14h4"}],["path",{d:"M2 18h4"}],["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2"}],["path",{d:"M16 2v20"}]],children:(d,v)=>{var _=xe(),f=ve(_);Ge(f,r,"default",{}),G(d,_)},$$slots:{default:!0}}))}var Fe=z('<div class="p-4 border-b border-border"><h3 class="font-semibold"> </h3> <p class="text-sm text-muted-foreground"> </p></div>'),Ae=(m,r)=>r.toggleSort("name"),Ne=(m,r)=>r.toggleSort("kpi"),Oe=(m,r)=>r.toggleSort("target"),$e=(m,r,x)=>r(e(x).id),Te=z('<tr class="hover:bg-muted/50"><td class="px-4 py-3"> </td><td class="px-4 py-3 hidden md:table-cell"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3 hidden lg:table-cell"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3 hidden xl:table-cell"> </td><td class="px-4 py-3"><button class="inline-flex items-center gap-1.5 px-2.5 py-1.5 text-sm text-primary bg-primary/10 hover:bg-primary/20 rounded-md" title="View Action Plans"><!>View</button></td><td class="px-4 py-3 text-center"><span class="inline-flex items-center gap-1 px-2.5 py-1 text-sm font-medium bg-red-100 text-red-700 rounded-lg"><!> </span></td></tr>'),De=z('<div class="overflow-x-auto bg-card rounded-lg shadow border border-border"><!> <table class="min-w-full table-auto"><thead class="bg-muted/50"><tr><th class="px-4 py-3 text-left"><button class="flex items-center gap-1 hover:text-primary">Objective <!></button></th><th class="px-4 py-3 text-left hidden md:table-cell">Strategic Initiatives</th><th class="px-4 py-3 text-left"><button class="flex items-center gap-1 hover:text-primary">KPI <!></button></th><th class="px-4 py-3 text-left hidden lg:table-cell">Persons Involved</th><th class="px-4 py-3 text-left"><button class="flex items-center gap-1 hover:text-primary">Target <!></button></th><th class="px-4 py-3 text-left hidden xl:table-cell">Evaluation Measures</th><th class="px-4 py-3 text-left w-[120px]">Action Plans</th><th class="px-4 py-3 text-left">Plans Created</th></tr></thead><tbody class="divide-y divide-border"></tbody></table></div>');function je(m,r){pe(r,!0);const x=y=>{Ie(`/plans/operationalPlans/${y}`)};var n=De(),d=a(n);_e(d,()=>r.selectedGoal,y=>{var c=Fe(),w=a(c),k=a(w);t(w);var M=l(w,2),N=a(M,!0);t(M),t(c),Q(()=>{h(k,`Strategic Goal No ${r.selectedGoal.goal_no??""}`),h(N,r.selectedGoal.name)}),G(y,c)});var v=l(d,2),_=a(v),f=a(_),i=a(f),p=a(i);p.__click=[Ae,r];var F=l(a(p)),A=O(()=>r.sortField==="name"?"text-primary":"");le(F,{size:16,get class(){return e(A)}}),t(p),t(i);var q=l(i,2),L=a(q);L.__click=[Ne,r];var X=l(a(L)),U=O(()=>r.sortField==="kpi"?"text-primary":"");le(X,{size:16,get class(){return e(U)}}),t(L),t(q);var B=l(q,2),I=a(B);I.__click=[Oe,r];var Y=l(a(I)),Z=O(()=>r.sortField==="target"?"text-primary":"");le(Y,{size:16,get class(){return e(Z)}}),t(I),t(B),oe(3),t(f),t(_);var $=l(_);me($,21,()=>r.items,fe,(y,c)=>{var w=Te(),k=a(w),M=a(k,!0);t(k);var N=l(k),H=a(N,!0);t(N);var T=l(N),J=a(T,!0);t(T);var D=l(T),ee=a(D,!0);t(D);var s=l(D),o=a(s,!0);t(s);var g=l(s),R=a(g,!0);t(g);var C=l(g),S=a(C);S.__click=[$e,x,c];var te=a(S);Me(te,{size:16}),oe(),t(S),t(C);var V=l(C),E=a(V),j=a(E);Ce(j,{size:16});var K=l(j);t(E),t(V),t(w),Q(()=>{h(M,e(c).name),h(H,e(c).strategic_initiatives),h(J,e(c).kpi),h(ee,e(c).persons_involved),h(o,e(c).target),h(R,e(c).eval_measures),he(E,"title",`${e(c).notApproved??""} plans not approved`),h(K,` ${e(c).actionPlanCount??""}`)}),G(y,w)}),t($),t(v),t(n),G(m,n),ue()}ie(["click"]);var qe=z("<option> </option>"),Le=z('<div class="w-full md:w-[300px]"><label class="block mb-2 font-medium">Select Strategic Goal:</label> <select class="select select-bordered w-full bg-secondary border-secondary rounded-lg"><option disabled selected>Select a goal</option><!></select></div>');function Ve(m,r){let x=Se(r,"selectedGoalId",15,null);var n=Le(),d=l(a(n),2);d.__change=function(...f){var i;(i=r.onSelect)==null||i.apply(this,f)};var v=a(d);v.value=((v.__value="")==null,"");var _=l(v);me(_,17,()=>r.goals,fe,(f,i)=>{var p=qe(),F={},A=a(p);t(p),Q(()=>{F!==(F=e(i).id)&&(p.value=(p.__value=e(i).id)==null?"":e(i).id),h(A,`${e(i).goal_no??""} - ${e(i).name??""}`)}),G(f,p)}),t(d),t(n),ge(d,x),G(m,n)}ie(["change"]);var Ke=z('<div class="flex justify-center p-8"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div></div>'),Qe=(m,r)=>u(r,e(r)-1),Ue=(m,r)=>u(r,e(r)+1),Be=z('<!> <div class="flex flex-col sm:flex-row justify-between items-center gap-4"><div class="text-sm text-muted-foreground"> </div> <div class="flex flex-col sm:flex-row items-center gap-4"><select class="bg-secondary border-secondary rounded-lg px-2 py-1 focus:outline-none focus:ring-2 focus:ring-ring w-full sm:w-auto"><option>5 per page</option><option>10 per page</option><option>25 per page</option><option>50 per page</option></select> <div class="flex gap-2"><button class="px-3 py-1 rounded-lg border border-border hover:bg-muted disabled:opacity-50">Previous</button> <button class="px-3 py-1 rounded-lg border border-border hover:bg-muted disabled:opacity-50">Next</button></div></div></div>',1),He=z('<div class="flex flex-col gap-4 container mx-auto p-4"><div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"><div class="flex items-center gap-2"><!> <h1 class="text-2xl font-bold">Operational Plans Management</h1></div></div> <div class="flex flex-col md:flex-row justify-between items-center gap-4"><div class="flex flex-shrink-0 w-full md:w-auto"><!></div> <div class="flex items-center gap-4 w-full md:w-auto"><div class="relative flex-1"><!> <input type="text" placeholder="Search objectives..." class="pl-10 pr-4 py-2 bg-secondary border-secondary rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-ring"></div></div></div> <!></div>');function nt(m,r){pe(r,!0);let x=b(""),n=b(1),d=b(5),v=b("name"),_=b("asc"),f=b(!0),i=b(null),p=b(P([])),F=b(P([])),A=b("");const q=async()=>{await L(),await X(),e(p).length>0&&(u(i,P(e(p)[0].id)),await U()),u(f,!1)},L=async()=>{try{const{data:{session:s}}=await W.auth.getSession();if(!s||!s.user)return;const{data:o,error:g}=await W.from("profiles").select("department_id").eq("id",s.user.id).single();if(g){console.error("Error fetching user department:",g);return}u(A,P((o==null?void 0:o.department_id)||null))}catch(s){console.error("Error fetching user department:",s)}},X=async()=>{const{data:s,error:o}=await W.from("strategic_goals").select("id, name, goal_no");o?console.error("Error fetching strategic goals:",o):u(p,P(s||[]))},U=async()=>{if(!(!e(i)||!e(A))){u(f,!0);try{const{data:s,error:o}=await W.from("strategic_objectives").select(`
					id,
					name,
					strategic_initiatives,
					kpi,
					persons_involved,
					target,
					eval_measures,
					action_plans (
						id,
						department_id
					)
				`).eq("strategic_goal_id",e(i));o?console.error("Error fetching strategic objectives:",o):u(F,P((s||[]).map(g=>{const C=(g.action_plans||[]).filter(S=>S.department_id===e(A)).length;return{...g,actionPlanCount:C}})))}catch(s){console.error("Error fetching objectives:",s)}finally{u(f,!1)}}},B=s=>{e(v)===s?u(_,P(e(_)==="asc"?"desc":"asc")):(u(v,P(s)),u(_,"asc"))},I=O(()=>e(F).filter(s=>`${s.name} ${s.strategic_initiatives} ${s.kpi}`.toLowerCase().includes(e(x).toLowerCase())).sort((s,o)=>e(_)==="asc"?s[e(v)].localeCompare(o[e(v)]):o[e(v)].localeCompare(s[e(v)]))),Y=O(()=>e(I).slice((e(n)-1)*e(d),e(n)*e(d))),Z=O(()=>Math.ceil(e(I).length/e(d)));q();var $=He(),y=a($),c=a(y),w=a(c);ze(w,{class:"w-8 h-8 text-primary"}),oe(2),t(c),t(y);var k=l(y,2),M=a(k),N=a(M);Ve(N,{get goals(){return e(p)},get selectedGoalId(){return e(i)},set selectedGoalId(s){u(i,P(s))},onSelect:U}),t(M);var H=l(M,2),T=a(H),J=a(T);Ee(J,{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground",size:20});var D=l(J,2);be(D),t(T),t(H),t(k);var ee=l(k,2);_e(ee,()=>e(f),s=>{var o=Ke();G(s,o)},s=>{var o=Be(),g=ve(o),R=O(()=>e(p).find(se=>se.id===e(i)));je(g,{get items(){return e(Y)},get sortField(){return e(v)},get sortDirection(){return e(_)},toggleSort:B,get selectedGoal(){return e(R)}});var C=l(g,2),S=a(C),te=a(S);Q(()=>h(te,`Showing ${(e(n)-1)*e(d)+1} to ${Math.min(e(n)*e(d),e(I).length)??""} of ${e(I).length??""} results`)),t(S);var V=l(S,2),E=a(V),j=a(E);j.value=(j.__value=5)==null?"":5;var K=l(j);K.value=(K.__value=10)==null?"":10;var ae=l(K);ae.value=(ae.__value=25)==null?"":25;var ne=l(ae);ne.value=(ne.__value=50)==null?"":50,t(E);var de=l(E,2),re=a(de);re.__click=[Qe,n];var ce=l(re,2);ce.__click=[Ue,n],t(de),t(V),t(C),Q(()=>{re.disabled=e(n)===1,ce.disabled=e(n)===e(Z)}),ge(E,()=>e(d),se=>u(d,se)),G(s,o)}),t($),ye(D,()=>e(x),s=>u(x,s)),G(m,$),ue()}ie(["click"]);export{nt as component};
